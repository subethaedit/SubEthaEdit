<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE syntax SYSTEM "syntax.dtd">
<syntax>

    <head>
        <name>Perl</name> <!-- The definitions title -->
        <charsintokens><![CDATA[_0987654321abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ@$]]></charsintokens> <!-- Valid Characters for Variables -->
    </head>

    <states>
    
        <default id="Base" scope="meta.default">
            <keywords id="Keywords" useforautocomplete="yes" scope="keyword.control">
                <string>if</string>
                <string>unless</string>
                <string>else</string>
                <string>elsif</string>
                <string>while</string>
                <string>until</string>
                <string>for</string>
                <string>each</string>
                <string>foreach</string>
                <string>next</string>
                <string>last</string>
                <string>break</string>
                <string>continue</string>
                <string>return</string>
                <string>use</string>
                <string>no</string>
                <string>require</string>
                <string>my</string>
                <string>our</string>
                <string>local</string>
                <string>BEGIN</string>
                <string>END</string>
                <string>require</string>
                <string>package</string>
                <string>sub</string>
                <string>do</string>
                <string>__END__</string>
                <string>__DATA__</string>
                <string>__FILE__</string>
                <string>__LINE__</string>
                <string>__PACKAGE__</string>
                <string>and</string>
                <string>or</string>
                <string>not</string>
                <string>eq</string>
                <string>ne</string>
            </keywords>
            <keywords id="Pragmas" useforautocomplete="yes" scope="keyword">
                <string>strict</string>
                <string>english</string>
                <string>warnings</string>
                <string>vars</string>
                <string>subs</string>
                <string>utf8</string>
                <string>sigtrap</string>
                <string>locale</string>
                <string>open</string>
                <string>less</string>
                <string>integer</string>
                <string>filetest</string>
                <string>constant</string>
                <string>bytes</string>
                <string>diagnostics</string>
            </keywords>
            <keywords id="Functions" useforautocomplete="yes" scope="support.subroutine.function">
                <string>abs</string>
                <string>accept</string>
                <string>alarm</string>
                <string>atan2</string>
                <string>bind</string>
                <string>binmode</string>
                <string>bless</string>
                <string>caller</string>
                <string>chdir</string>
                <string>chmod</string>
                <string>chomp</string>
                <string>chop</string>
                <string>chown</string>
                <string>chr</string>
                <string>chroot</string>
                <string>close</string>
                <string>closedir</string>
                <string>connect</string>
                <string>cos</string>
                <string>crypt</string>
                <string>dbmclose</string>
                <string>dbmopen</string>
                <string>defined</string>
                <string>delete</string>
                <string>die</string>
                <string>dump</string>
                <string>endgrent</string>
                <string>endhostent</string>
                <string>endnetent</string>
                <string>endprotoent</string>
                <string>endpwent</string>
                <string>endservent</string>
                <string>eof</string>
                <string>eval</string>
                <string>exec</string>
                <string>exists</string>
                <string>exit</string>
                <string>exp</string>
                <string>fcntl</string>
                <string>fileno</string>
                <string>flock</string>
                <string>fork</string>
                <string>format</string>
                <string>formline</string>
                <string>getc</string>
                <string>getgrent</string>
                <string>getgrgid</string>
                <string>getgrnam</string>
                <string>gethostbyaddr</string>
                <string>gethostbyname</string>
                <string>gethostent</string>
                <string>getlogin</string>
                <string>getnetbyaddr</string>
                <string>getnetbyname</string>
                <string>getnetent</string>
                <string>getpeername</string>
                <string>getpgrp</string>
                <string>getppid</string>
                <string>getpriority</string>
                <string>getprotobyname</string>
                <string>getprotobynumber</string>
                <string>getprotoent</string>
                <string>getpwent</string>
                <string>getpwnam</string>
                <string>getpwuid</string>
                <string>getservbyname</string>
                <string>getservbyport</string>
                <string>getservent</string>
                <string>getsockname</string>
                <string>getsockopt</string>
                <string>glob</string>
                <string>gmtime</string>
                <string>goto</string>
                <string>grep</string>
                <string>hex</string>
                <string>import</string>
                <string>index</string>
                <string>int</string>
                <string>ioctl</string>
                <string>join</string>
                <string>keys</string>
                <string>kill</string>
                <string>last</string>
                <string>lc</string>
                <string>lcfirst</string>
                <string>length</string>
                <string>link</string>
                <string>listen</string>
                <string>localtime</string>
                <string>lock</string>
                <string>log</string>
                <string>lstat</string>
                <string>map</string>
                <string>mkdir</string>
                <string>msgctl</string>
                <string>msgget</string>
                <string>msgrcv</string>
                <string>msgsnd</string>
                <string>oct</string>
                <string>open</string>
                <string>opendir</string>
                <string>ord</string>
                <string>pack</string>
                <string>pipe</string>
                <string>pop</string>
                <string>pos</string>
                <string>print</string>
                <string>printf</string>
                <string>prototype</string>
                <string>push</string>
                <string>quotemeta</string>
                <string>rand</string>
                <string>read</string>
                <string>readdir</string>
                <string>readline</string>
                <string>readlink</string>
                <string>recv</string>
                <string>redo</string>
                <string>ref</string>
                <string>rename</string>
                <string>reset</string>
                <string>return</string>
                <string>reverse</string>
                <string>rewinddir</string>
                <string>rindex</string>
                <string>rmdir</string>
                <string>scalar</string>
                <string>seek</string>
                <string>seekdir</string>
                <string>select</string>
                <string>semctl</string>
                <string>semget</string>
                <string>semop</string>
                <string>send</string>
                <string>setgrent</string>
                <string>sethostent</string>
                <string>setnetent</string>
                <string>setpgrp</string>
                <string>setpriority</string>
                <string>setprotoent</string>
                <string>setpwent</string>
                <string>setservent</string>
                <string>setsockopt</string>
                <string>shift</string>
                <string>shmctl</string>
                <string>shmget</string>
                <string>shmread</string>
                <string>shmwrite</string>
                <string>shutdown</string>
                <string>sin</string>
                <string>sleep</string>
                <string>socket</string>
                <string>socketpair</string>
                <string>sort</string>
                <string>splice</string>
                <string>split</string>
                <string>sprintf</string>
                <string>sqrt</string>
                <string>srand</string>
                <string>stat</string>
                <string>study</string>
                <string>sub</string>
                <string>substr</string>
                <string>symlink</string>
                <string>syscall</string>
                <string>sysread</string>
                <string>sysseek</string>
                <string>system</string>
                <string>syswrite</string>
                <string>tell</string>
                <string>telldir</string>
                <string>tie</string>
                <string>time</string>
                <string>times</string>
                <string>truncate</string>
                <string>uc</string>
                <string>ucfirst</string>
                <string>umask</string>
                <string>undef</string>
                <string>unlink</string>
                <string>unpack</string>
                <string>unshift</string>
                <string>untie</string>
                <string>utime</string>
                <string>values</string>
                <string>vec</string>
                <string>wait</string>
                <string>waitpid</string>
                <string>wantarray</string>
                <string>warn</string>
                <string>write</string>
            </keywords>

            <keywords id="Numbers" useforautocomplete="no" scope="language.constant.numeric">
				<regex>(?&lt;![\w\d_])((?:[+-]?(?:(?:[0-9]+\.[0-9]*)|(?:\.[0-9]+))(?:[eE][+\-]?[0-9]+)?[fFlL]?)|(?:(?:(?:[1-9][0-9]*)|0[0-7]*|(?:0[xX][0-9a-fA-F]+))(?:(?:[uU][lL]?)|(?:[lL][uU]?))?))(?![\w\d_])</regex>
            </keywords>

            <keywords id="Hexadecimal Characters" useforautocomplete="no" scope="language.constant.numeric">
				<regex>(\\x[0-9a-fA-F]{2,4}|\\x\{[0-9a-fA-F]{2,4}\})</regex>
            </keywords>
            
            <keywords id="Variables" useforautocomplete="no" scope="language.variable">
                <regex>(\$(?:[\w\d])+)</regex>
            </keywords>

            <state id="q Operators with Curlies" scope="string.single">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)q[qxwr]?\{</regex><autoend>}</autoend></begin>
                <end><regex>[^\\]\}</regex></end>
                <state-link state="SingleString"/>
                <state-link state="DoubleString"/>
            </state>

            <state id="q Operators with Slashes" scope="string.single">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)q[qxw]?(?&lt;qclosure&gt;[^\d\w\s\(]).*?[^\\](?=\k&lt;qclosure&gt;)</regex></begin>
                <end><regex>.</regex></end>
            </state>
    
            <state id="q Operators with Parenthesis" scope="string.single">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)q[qxwr]?\(</regex></begin>
                <end><regex>[^\\]\)</regex></end>
            </state>
    
            <state id="qr Operator with Slashes" scope="string.single">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)qr(?&lt;qrclosure&gt;[^\d\w\s\(]).+?[^\\](?=\k&lt;qrclosure&gt;)</regex></begin>
                <end><regex>.[imosx]*</regex></end>
            </state>
    
            <state id="m Operator with Slashes" scope="string.regex">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)m(?&lt;mclosure&gt;[^\d\w\s\(]).*?[^\\](?=\k&lt;mclosure&gt;)</regex></begin>
                <end><regex>.[cgimosx]*</regex></end>
            </state>
    
            <state id="s Operator with Slashes" scope="string.regex">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)s(?&lt;sclosure&gt;[^\d\w\s\(])(?:.*?[^\\])?\k&lt;sclosure&gt;(?:.*?[^\\])?(?=\k&lt;sclosure&gt;)</regex></begin>
                <end><regex>.[egimosx]*</regex></end>
            </state>
    
            <state id="s Operator with Parenthesis" scope="string.regex">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)(?:tr|y|s)\([^\)]*\)\(</regex></begin>
                <end><regex>\)[egimosx]*</regex></end>
            </state>
    
            <state id="s Operator with Curlies" scope="string.regex">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)(?:tr|y|s)\{[^\}]*\}\{</regex></begin>
                <end><regex>\}[egimosx]*</regex></end>
            </state>
    
            <state id="tr, y Operator with Slashes" scope="string.regex">
                <begin><regex>(?&lt;=[^\w\d\$]|\A)(?:tr|y)(?&lt;yclosure&gt;[^\d\w\s\(])(?:.*?[^\\])?\k&lt;yclosure&gt;(?:.*?[^\\])?(?=\k&lt;yclosure&gt;)</regex></begin>
                <end><regex>.[cds]*</regex></end>
            </state>
    
            <state id="Backticks" scope="string.double">
                <begin><regex>(?&lt;!\$|\\)(?:\\\\)*`</regex></begin>
                <end><regex>(((?&lt;!\\)(\\\\)*)|^)`</regex></end>
            </state>
    
            <state id="POD style comments" type="comment" scope="comment">
                <begin><regex>(?&lt;=[\n\r])=(?=\w.*[\n\r])</regex></begin>
                <end><regex>(?&lt;=\s)=cut[^\n\r]*</regex></end>
                <import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>
            </state>
    
            <state id="Regular Expressions" scope="string.regex">
                <begin><regex>(?&lt;=[=,(])\s*/.*?[^\\](?=/[^\n\r]*;)</regex></begin>
                <end><regex>/[cgimosx]*</regex></end>
            </state>
    
            <state id="Regular Expressions 2" scope="string.regex">
                <begin><regex>(?&lt;=[=]\S)\s*/.*?[^\\](?=/[^\n\r]*;)</regex></begin>
                <end><regex>/[cgimosx]*</regex></end>
            </state>
    
            <state id="Regular Expressions 3" scope="string.regex">
                <begin><regex>\?[^:]*?[^\\](?=\?[^\n\r]*;)</regex></begin>
                <end><regex>\?</regex></end>
            </state>

            <state id="Regular Expressions 4" scope="string.regex">
                <begin><regex>(?&lt;==~) */</regex></begin>
                <end><regex>(?&lt;!\\)/</regex></end>
            </state>
    
            <state id="Singleline Comment" type="comment" scope="comment.line">
                <begin><regex>(?&lt;!\$)#</regex></begin>
                <end><regex>[\n\r]</regex></end>
                <import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>
            </state>
            
            <state id="SingleString" type="string" usespellchecking="yes" scope="string.double">
                <begin><regex>(?&lt;!\$|\\)(?:\\\\)*"</regex></begin>
                <end><regex>(?:(?&lt;!\\)(\\\\)*)"</regex></end>
            </state>
    
            <state id="DoubleString" type="string" usespellchecking="yes" scope="string.single">
                <begin><regex>(?&lt;!\$|\\)(?:\\\\)*'</regex></begin>
                <end><regex>(?:(?&lt;!\\)(\\\\)*)'</regex></end>
            </state>

            <state id="Heredoc" type="string" foldable="yes" scope="string.here-doc.perl">
                <begin><string>&lt;&lt;[ \t]*["']*(?&lt;heredoc&gt;.*?)["']*;</string></begin>
                <end><regex>(?#see-insert-start-group:heredoc)</regex></end>
            </state>

            <state id="Block" type="block" foldable="yes" scope="meta.block">
                <begin><regex>{</regex></begin>
                <end><regex>}</regex></end>
                <import mode="Perl"/>
            </state>

        </default>
    </states>
</syntax>
