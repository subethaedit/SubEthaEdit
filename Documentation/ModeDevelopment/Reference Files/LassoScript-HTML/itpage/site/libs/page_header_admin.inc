<?Lassoscript// Last modified 11/26/10 by ECL, Landmann InterActive// FUNCTIONALITY// Page header// CHANGE NOTES// 11/20/07// Recoded for CMS v. 3.0// 12/20/07// Removed Nifty info from header// 1/10/08// Added set focus to User_LoginID for login form// 2/12/08// Fixed the tooltip not working - the jTip theme code was missing// 4/23/08// Moved the setfocus for login form to page_footer.inc// 4/24/08// Updated to jQuery 1.2.3// 4/28/08// Added Error=6003 to session expired page// 4/30/08// Changed logout_dialog URL// 5/1/08// Fixed auto-logout timing, added "var" before JS definition of "ID" to get rid of Javascript error// 6/8/08// Add text/javascript to some script links// 6/23/08// Added in doctype so form spacing is correct// 12/5/08// Added tooltip to Images area// 10/31/09// Added ckeditor.js// 11/23/09// Upgraded to jQuery 1.2.6// 8/21/10// Added admin debugging// 11/26/10// Getting rid of tooltips on content pages, as it's somehow conflicting with ckeditor// Switch to load jQuery Cluetip JS and css// Load it for Content and Manage Heirarchy pages// ALSO used the Date PickerIf((Var:'vDataType') == 'Content' ||	(Response_Filepath) >> 'manage_heirarchy.lasso' ||	(Response_Filepath) >> 'library.lasso');	Var:'LoadToolTip' = true;Else;	Var:'LoadToolTip' = false;/If;?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><html><head>	<title>[$svSys_Title]</title>	<meta http-equiv="Content-Language" content="[$svSys_Language]">	<meta http-equiv="content-type" content="text/html; charset=utf-8">	<meta name="expires" content="0">	<meta name="author" content="[$svSys_Author]">	<meta name="copyright" content="[$svSys_Copyright]">	<meta name="robots" content="disallow">	<meta name="description" content="[$svSys_Description]">	<meta name="keywords" content="[$svSys_Keywords]">	<link rel="stylesheet" type="text/css" href="[$svCssPath]admin.css">	[If: $LoadToolTip == true]<link rel="stylesheet" href="[$svCSSPath]jquery.cluetip.css" type="text/css">[/If]	<link rel="stylesheet" type="text/css" href="[$svCssPath]niftyCorners.css">	<link rel="stylesheet" type="text/css" href="[$svCssPath]niftyPrint.css"  media="print">	<link rel="stylesheet" href="[$svCssPath]thickbox.css" type="text/css" media="screen">	[If: $LoadToolTip == true]<link rel="stylesheet" href="[$svCssPath]datePicker.css" type="text/css" media="screen">[/If]	<script type="text/javascript" src="[$svJSPath]nifty.js"></script>	<script type="text/javascript" src="[$svJSPath]warnings.js"></script>	<script type="text/javascript" src="[$svJSPath]jquery-1.2.6.min.js"></script>	<script type="text/javascript" src="[$svJSPath]jquery.dimensions.js"></script>	<script type="text/javascript" src="[$svJSPath]thickbox.js"></script>	<script type="text/javascript" src="[$svFCKEditorPath]ckeditor.js"></script>	[If: $LoadToolTip == true]<script type="text/javascript" src="[$svJSPath]date.js"></script>	<script type="text/javascript" src="[$svJSPath]jquery.datePicker.js"></script>[/If]	[If((Var:'vDataType') != 'Content')]<script type="text/javascript" src="[$svJSPath]jquery.cluetip.js"></script>	<script language="JavaScript" type="text/javascript">		$(document).ready(function() {		// cluetip 0.9.0 jQuery plugin		// Downloaded 11/3/07		// jTip theme		  $('a.jt:eq(0)').cluetip({cluetipClass: 'jtip', arrows: true, dropShadow: false,			sticky: true,			mouseOutClose: true,			closePosition: 'title',			closeText: '<img src="[$svImagesPath]cross.png" alt="close" />'		  });		  $('a.jt:eq(1)').cluetip({cluetipClass: 'jtip', arrows: true, dropShadow: false, hoverIntent: false});[noprocess]		  $('span[@title]').css({borderBottom: '1px solid #900'}).cluetip({splitTitle: '|', arrows: true, dropShadow: false, cluetipClass: 'jtip'});[/noprocess]		  $('a.jt:eq(2)').cluetip({cluetipClass: 'jtip', arrows: true, dropShadow: false, height: '150px', sticky: true});		});	</script>[/If]	<script type="text/javascript" language="JavaScript">		<!-- From Nifty Corners -->		<!-- We need a "Rounded" declaration for each window, one will not do -->		window.onload=function(){		if(!NiftyCheck())			return;		Rounded("div#nifty","top","transparent","#FFFFFF","border #C0C0C0");		Rounded("div#nifty","bottom","transparent","#FFFFFF","small border #C0C0C0");		Rounded("div#nifty2","top","transparent","#FFFFFF","border #C0C0C0");		Rounded("div#nifty2","bottom","transparent","#FFFFFF","small border #C0C0C0");		Rounded("div#niftysidebar","top","transparent","#727272","border #C0C0C0");		Rounded("div#niftysidebar","bottom","transparent","#727272","small border #C0C0C0");		Rounded("div#niftysidebar2","top","transparent","#727272","border #C0C0C0");		Rounded("div#niftysidebar2","bottom","transparent","#727272","small border #C0C0C0");}		function ToggleDisplay(idOf)		{			var element = document.getElementById(idOf);			if (element != undefined)			{				if (element.style.display == 'none')				{ element.style.display = 'block'; }				else				{ element.style.display = 'none'; }			}		}	// Expand or collapse panel. Also switches images.	function exp_coll(ind)	{	 s = document.getElementById("sp_" + ind);	 i2 = document.getElementById("image_" + ind);		 if (s.style.display == 'none')	 {	   s.style.display = 'block';	   i2.src = "/site/images/bullet_downroundgreen.gif";	 }	 else if (s.style.display == 'block')	 {	   s.style.display = 'none';	   i2.src = "/site/images/bullet_rightroundyellow.gif";	 }	}	</script>	<script language="JavaScript" type="text/javascript">[html_comment]// Used with permission from Tami Williams, 12/20/07// Part of a system that auto-logs out user after 30 minutes// Look for popup blocker, use this in Countdown functionfunction IsPopupBlocker() {	var oWin = window.open("","testpopupblocker","width=100,height=50,top=5000,left=5000");	if (oWin==null || typeof(oWin)=="undefined") {		return true;	} else {	oWin.close();	return false;	}}// Only run logout countdown IF this layout is not being loaded in a popup window// and not just sitting at login page[if: (Response_Filepath) >> 'login' || (var:'svUser_ID') == '']	window.name = "main";[Else]	window.name = "main";	var counter = 0;	var nbrminutes = 29;	var interval = nbrminutes * 60;		// call Countdown function in 2 seconds after first load	var ID=window.setTimeout("Countdown();",2000);		function Countdown() {	  counter++;// 	window.status="The counter is now at "+counter;	   	// increment counter variable every 1000 milliseconds / 1 second	var ID=window.setTimeout("Countdown();",1000);	  	// 60 seconds = 1 minute; interval is # seconds that = 29 minutes	// display logout dialog pop up window after 29 minutes have passed		if (counter == interval){		if (IsPopupBlocker()) {		var popblocker = "Yes";		}	}		if (counter == interval && popblocker == 'Yes') {	window.location = "login.lasso?Action=logout&Error=6003" ;		  }		  else		  {			if (counter == interval) {			logwin = openlogoutwin('/admin/logout_dialog.lasso');			window.clearTimeout(ID);			}		  }	}		function StopCountdown() {	window.clearTimeout(ID);	}[/If][/html_comment]	</script>[If: $LoadToolTip == true]	<script type="text/javascript" charset="utf-8">		// Date Picker		$(function()		{			$('#inline-1')				.datePicker(					{					inline:true					}				);			$('#inline-2')				.datePicker(					{					inline:true,					}				);			$('.date-pick').datePicker({startDate:'01/01/2010'});		});	</script>[/If]</head><body><div align="left">	<img name="banner" src="[$svImagesPath]admin_header.gif" width="650" height="80" alt="Banner"></div><?Lassoscript// UNCOMMENT FOR DEBUGGING SESSIONS/*Local('VarDumpSession' = string);#VarDumpSession += ('<p class="debug"><font color="green"><strong>SESSION INFO</strong></font><br>\n');#VarDumpSession += ('<strong>Session_ID Admin</strong> = ' (Session_ID: -Name=$svSessionAdminName) '<br>\n');#VarDumpSession += ('<strong>Session_Result Admin</strong> = ' (Session_Result) '<br>\n');#VarDumpSession += ('<strong>Client_IP</strong> = ' (Client_IP) '<br>\n');#VarDumpSession += ('<strong>svUser_ID</strong> = ' (Var:'svUser_ID') '<br>\n');#VarDumpSession += ('</p>\n');Output:(#VarDumpSession),-EncodeNone;Log_Critical((Var:'svDomain')+' PAGE LOAD on '+(Server_Date: -Extended)+' '+(Server_Time: -Extended)+'\n');// Log_Critical('CLIENT TYPE: '+(Client_Type)+'\n');Log_Critical('URL = '+'http://'+(Var:'svDomain')+(Response_FilePath)+'\n');Log_Critical((Var:'svDomain')+' CLIENT_IP = '+(Client_IP)+'\n');Log_Critical((Var:'svDomain')+' CLIENT_TYPE = '+(Client_Type)+'\n');Log_Critical((Var:'svDomain')+' PAGE TOP svUser_ID = '+(Var:'svUser_ID')+'\n');Log_Critical((Var:'svDomain')+' PAGE TOP Session_ID Admin = '+(Session_ID: -Name=$svSessionAdminName)+'\n');Log_Critical((Var:'svDomain')+' PAGE TOP Session_Result = '+(Session_Result)+'\n');*/?>